<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Pay — SpicyKik</title>
    <style>
      body {
        font-family: Arial, Helvetica, sans-serif;
        margin: 24px;
        color: #222;
      }
      main {
        max-width: 720px;
        margin: 0 auto;
      }
      #summary {
        border: 1px solid #eee;
        padding: 16px;
        border-radius: 6px;
        margin-bottom: 12px;
      }
      #items div {
        padding: 6px 0;
        border-bottom: 1px dashed #f0f0f0;
      }
      #total {
        font-weight: 700;
        margin-top: 12px;
      }
      #pay-now {
        background: #0a74da;
        color: #fff;
        border: none;
        padding: 10px 16px;
        border-radius: 4px;
        cursor: pointer;
      }
      #result {
        margin-top: 12px;
        color: green;
      }
    </style>
  </head>
  <body>
    <main>
      <h1>Checkout</h1>
      <div id="summary">
        <div id="items"></div>
        <div id="total">Total: Rs. 0.00</div>
      </div>
      <button id="pay-now">Pay Now</button>
      <div id="result" style="display: none"></div>
    </main>

    <script>
      (function () {
        function formatCurrency(cents) {
          return "Rs. " + (cents / 100).toFixed(2);
        }
        function getQuery(name) {
          return new URLSearchParams(location.search).get(name);
        }
        var amountCents = parseInt(getQuery("amount_cents"));
        var STORAGE_KEY = "spicykik_cart_v1";
        function loadCart() {
          try {
            var raw = localStorage.getItem(STORAGE_KEY);
            return raw ? JSON.parse(raw) : { items: [] };
          } catch (e) {
            return { items: [] };
          }
        }
        function computeFromCart() {
          var cart = loadCart();
          var subtotal = 0;
          (cart.items || []).forEach(function (i) {
            subtotal += (i.price_cents || 0) * (i.quantity || 0);
          });
          return { subtotal: subtotal, items: cart.items || [] };
        }

        var data;
        if (!isNaN(amountCents)) {
          data = { subtotal: amountCents, items: loadCart().items || [] };
        } else {
          data = computeFromCart();
        }

        document.getElementById("total").textContent =
          "Total: " + formatCurrency(data.subtotal || 0);
        var itemsEl = document.getElementById("items");
        if (data.items && data.items.length) {
          data.items.forEach(function (it) {
            var div = document.createElement("div");
            div.textContent =
              (it.quantity || 1) +
              " x " +
              (it.title || "Item") +
              " — " +
              formatCurrency((it.price_cents || 0) * (it.quantity || 0));
            itemsEl.appendChild(div);
          });
        } else {
          itemsEl.textContent = "No items to display.";
        }

        document
          .getElementById("pay-now")
          .addEventListener("click", function () {
            var btn = this;
            btn.disabled = true;
            btn.textContent = "Processing...";
            setTimeout(function () {
              try {
                localStorage.removeItem(STORAGE_KEY);
              } catch (e) {}
              var res = document.getElementById("result");
              res.style.display = "block";
              res.textContent =
                "Payment successful. Paid " +
                formatCurrency(data.subtotal || 0) +
                ". Thank you!";
              btn.textContent = "Paid";
              setTimeout(function () {
                window.location.href = "./index.html";
              }, 1800);
            }, 900);
          });
      })();
    </script>
  </body>
</html>
<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TandoorBaaz Payment</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        text-align: center;
        background: #f5f5f5;
      }
      .amount-display {
        font-size: 24px;
        font-weight: bold;
        margin: 20px 0;
        color: #333;
      }
      .payment-card {
        background: white;
        border-radius: 15px;
        padding: 15px;
        margin: 15px auto;
        width: 80%;
        max-width: 300px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        text-decoration: none;
        color: #333;
        transition: transform 0.2s;
      }
      .payment-card:hover {
        transform: scale(1.02);
      }
      .app-logo {
        width: 48px;
        height: 48px;
        margin-right: 15px;
        object-fit: contain;
        padding: 4px;
      }
      .app-name {
        font-size: 18px;
        font-weight: 500;
      }
      .paytm-card {
        border-left: 5px solid #00b9f1;
      }
      .phonepe-card {
        border-left: 5px solid #5f259f;
      }
      .gpay-card {
        border-left: 5px solid #2da94f;
      }
    </style>
  </head>
  <body>
    <h2>Complete Your Payment</h2>
    <div class="amount-display" id="amount"></div>

    <a id="paytm-link" class="payment-card paytm-card">
      <img
        src="https://www.logo.wine/a/logo/Paytm/Paytm-Logo.wine.svg"
        class="app-logo"
        alt="Paytm"
      />
      <span class="app-name">Pay with Paytm</span>
    </a>

    <!-- <a id="phonepe-link" class="payment-card phonepe-card">
        <img src="https://i.pinimg.com/736x/88/ff/f3/88fff330d69dcd30c90efbfa6410376d.jpg" class="app-logo" alt="PhonePe">
        <span class="app-name">Pay with PhonePe</span>
    </a> -->

    <a id="gpay-link" class="payment-card gpay-card">
      <img
        src="https://cdn1.iconfinder.com/data/icons/logos-brands-in-colors/436/Google_Pay_GPay_Logo-1024.png"
        class="app-logo"
        alt="Google Pay"
      />
      <span class="app-name">Pay with Google Pay</span>
    </a>

    <script>
      const params = new URLSearchParams(window.location.search);
      const amount = params.get("amount");
      const orderId = params.get("orderId");

      document.getElementById("amount").innerHTML = `
        Order #${orderId}<br>
        Amount: Rs ${amount}
    `;

      const upiIds = {
        paytm: "vykanand@ptaxis",
        // phonepe: 'vykanand@ybl',
        gpay: "nishagautamnishu@okhdfcbank",
      };

      const merchantName = "TandoorBaaz";

      // Add order reference to payment links
      document.getElementById("paytm-link").href =
        `paytmmp://pay?pa=${upiIds.paytm}&pn=${merchantName}&am=${amount}&cu=INR&tr=${orderId}`;
      document.getElementById("phonepe-link").href =
        `phonepe://pay?pa=${upiIds.phonepe}&pn=${merchantName}&am=${amount}&cu=INR&tr=${orderId}`;
      document.getElementById("gpay-link").href =
        `gpay://upi/pay?pa=${upiIds.gpay}&pn=${merchantName}&am=${amount}&cu=INR&tr=${orderId}`;
    </script>
  </body>
</html>
